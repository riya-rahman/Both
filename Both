import numpy as np
import matplotlib.pyplot as plt
l=0.245
dx=0.005
nx=int(l/dx)+1
t=3600
dt=2
nt=int(t/dt)+1
dT=0.2
hs=189000
k1=1.13
k2=0.255
r1=1000
r2=794
c1=2000
c2s=2150
c2l=2180
c3=(hs/(2*dT))
h=8.3
Tm=300
a1=k1/(r1*c1)##concrete
a2s=k2/(r2*c2s)
a2l=k2/(r2*c2l)
a3=k2/(r2*c3)
Fo=(a1*dt)/(dx**2)
To=302
Bi=(h*dx)/k1
lamda1=(a1*dt)/(dx**2)
lamda2s=(a2s*dt)/(dx**2)
lamda2l=(a2l*dt)/(dx**2)
lamda3=(a3*dt)/(dx**2)
P=[301.65281802,301.6357856,301.62033456,301.60309274,301.58401459,301.56306131,301.54020103,301.51540888,301.48866704,301.45996485,301.42929876,301.39667237,301.36209635,301.3255884,301.28717317,301.24688209,301.20475333,301.16083154,301.11516774,301.06781908,301.01884866,300.82508246,300.62651886,300.42429765,300.21960651,300.01366523,300.01341369,300.01315875,300.01290077,300.01264011,300.01237711,300.0121121,300.01184537,300.01157724,300.01130795,300.01103778,300.01076695,300.01049569,300.01022419,300.00995263,300.00968117,300.00940994,300.00913907,300.00886865,300.00859878,300.00832951,300.00806088,300.00779293,300.00752566,300.00725907]
#P=[301.57081665,301.5507746,301.53231795,301.51207466,301.48999933,301.46605333,301.44020494,301.41242942,301.38270914,301.35103358,301.31739938,301.28181028,301.24427714,301.20481783,301.16345718,301.12022681,301.07516506,301.02831678,300.97973317,300.92947159,300.87759532,300.67271268,300.46306319,300.24978971,300.03408304,299.8171661,299.81691276,299.81666741,299.81643043,299.81620219,299.81598304,299.81577333,299.81557338,299.8153832,299.815204,299.81503516,299.81487724,299.81473049,299.81459515,299.81447142,299.8143595,299.81425957,299.81417179,299.81409629,299.81403319,299.81398259,299.81394457,299.8139192,299.8139065,299.8139065 ]
T=np.array(P)
PP=[302.16917597,302.17132384,302.17550169,302.17835101,302.17983834,302.17993532,302.17861876,302.17587067,302.17167821,302.16603369,302.15893443,302.15038268,302.14038544,302.12895434,302.11610536,302.10185868,302.08623838,302.06927219,302.05099121,302.03142959,302.01062426,301.98861459,301.96544206,301.94114995,301.91578301,301.88938713,301.86200905,301.833696,301.80449545,301.77445478,301.74362104,301.71204063,301.6797591,301.64682089,301.61326914,301.57914545,301.54448974,301.50934005,301.47373245,301.43770086,301.40127698,301.36449019,301.3273675,301.28993347,301.25221021,301.21421736,301.17597207,301.13748906,301.09878062,301.05985668]
#PP=[302.55330312,302.5696906,302.5883824,302.60602995,302.6226098,302.63810378,302.65249903,302.66578799,302.67796843,302.68904337,302.69902099,302.70791451,302.71574205,302.72252644,302.72829498,302.73307926,302.73691485,302.73984106,302.74190058,302.74313923,302.74360563,302.74335079,302.74242785,302.7408917,302.7387986,302.73620587,302.73317153,302.72975395,302.72601151,302.72200226,302.71778364,302.71341214,302.70894301,302.70442998,302.69992499,302.69547794,302.69113648,302.68694572,302.68294812,302.6791832,302.67568745,302.67249416,302.6696332,302.66713111,302.66501067,302.66329109,302.66198782,302.66111248,302.66067287,302.66067287]
T1=np.array(PP)
Troom=300
N=[]
NN=[]
i=[29,29,29,31,33,33,31,29,29]
#,28,28,32,33,33,29,28,29]
n=1
while n==1:
    Tn=T.copy()
    if n%5400==0:
        k=int(n/5400)
        To=i[k]+273
    
        
    T[1:20]=Tn[1:20]+lamda1*(Tn[2:21]-2*Tn[1:20]+Tn[0:19])
    if Tn[20]<(Tm-dT):
        T[20]=(dt/(dx**2))*(a2s*Tn[21]-(a1+a2s-((dx**2)/dt))*Tn[20]+a1*Tn[19])
    elif Tn[20]>(Tm+dT):        
        T[20]=(dt/(dx**2))*(a2l*Tn[21]-(a1+a2l-((dx**2)/dt))*Tn[20]+a1*Tn[19])
    elif Tn[20]>(Tm-dT) and Tn[20]<(Tm+dt):        
        T[20]=(dt/(dx**2))*(a3*Tn[21]-(a1+a3-((dx**2)/dt))*Tn[20]+a1*Tn[19])    
    if any(Tn[21:25])<(Tm-dt):
        T[21:25]=Tn[21:25]+lamda2s*(Tn[22:26]-2*Tn[21:25]+Tn[20:24])
    elif any(Tn[21:25])>(Tm+dT):
        T[21:25]=Tn[21:25]+lamda2l*(Tn[22:26]-2*Tn[21:25]+Tn[20:24])
    elif any(Tn[21:25])>(Tm-dT) and any(Tn[21:25])<(Tm+dt):
        T[21:25]=Tn[21:25]+lamda3*(Tn[22:26]-2*Tn[21:25]+Tn[20:24])
    if Tn[25]<(Tm-dT):
        T[25]=(dt/(dx**2))*(a1*Tn[26]-(a1+a2s-((dx**2)/dt))*Tn[25]+a2s*Tn[24])
    elif Tn[25]>(Tm+dT):
        T[25]=(dt/(dx**2))*(a1*Tn[26]-(a1+a2l-((dx**2)/dt))*Tn[25]+a2l*Tn[24])
    elif Tn[25]>(Tm-dT) and Tn[25]<(Tm+dt):
        T[25]=(dt/(dx**2))*(a1*Tn[26]-(a1+a3-((dx**2)/dt))*Tn[25]+a3*Tn[24])    
    
    T[26:-1]=Tn[26:-1]+lamda1*(Tn[27:]-2*Tn[26:-1]+Tn[25:-2])
    T[0]=Tn[0]*(1-2*Fo*(1+Bi))+2*Fo*Bi*To+2*Fo*Tn[1]
    T[-1]=(1/(h+(k1/dx)))*(8.3*Troom+(k1/dx)*T[-2])       
    #T[-1]=Tn[-1]*(1-2*Fo*(1+Bi))+2*Fo*Tn[-2]+2*Bi*Troom*Fo
    T[-1]=T[-2]
    n=n+1
    #if n%10800==0:
        #N.append(T[49])
x=np.linspace(1,l,nx)
g=np.linspace(1,24,4)
plt.plot(x,T[::-1])
for q in range(0,50):
    
    N.append(T[q])
print(N)
To=302
n=1
while n==1:
    Tn=T1.copy()
    if  n%5400==0:
        k=int(n/5400)
        To=i[k]+273
    
            
    T1[1:-1]=Tn[1:-1]+lamda1*(Tn[2:]-2*Tn[1:-1]+Tn[0:-2])
    
    T1[0]=Tn[0]*(1-2*Fo*(1+Bi))+2*Fo*Bi*To+2*Fo*Tn[1]
    #T1[-1]=T1[-2]
    T1[-1]=(1/(h+(k1/dx)))*(8.3*Troom+(k1/dx)*T1[-2]) 
    #if n%10800==0:
        
        #NN.append(T1[49])
    n=n+1    
plt.plot(x,T1[::-1])
plt.show()
for q in range(0,50):
    NN.append(T1[q])
print(NN)        
